<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Password - Alfamind</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        html{background:#1a1a2e;height:100%}
        body{font-family:Arial,sans-serif;background:#fff;max-width:420px;margin:0 auto;min-height:100vh;display:flex;flex-direction:column;box-shadow:0 0 40px rgba(0,0,0,.3)}
        .status-bar{background:#e30613;padding:8px 16px;display:flex;justify-content:space-between;font-size:11px;color:#fff;font-weight:bold}
        .red-section{background:#e30613;padding:20px 24px 60px;position:relative;overflow:hidden}
        .red-section::after{content:'';position:absolute;bottom:-30px;left:-10%;width:120%;height:80px;background:#fff;border-radius:50% 50% 0 0}
        .top-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
        .logo{background:#fff;padding:6px 16px;border-radius:6px}
        .logo span{color:#e30613;font-weight:900;font-size:20px;font-style:italic}
        .back{color:#fff;font-size:22px;cursor:pointer;text-decoration:none;font-weight:bold}
        .hero-title{color:#fff;font-size:24px;font-weight:900;line-height:1.2;margin-bottom:10px}
        .hero-desc{color:#fff;font-size:15px;opacity:.95}
        .form-section{flex:1;padding:40px 24px 24px}
        .form-label{font-size:14px;color:#333;margin-bottom:10px}
        .form-label span{color:#e30613}
        .phone-display{font-size:15px;color:#667;margin-bottom:20px;padding:12px 16px;background:#f5f5f5;border-radius:8px}
        .form-input{width:100%;padding:14px 16px;border:1px solid #ddd;border-radius:8px;font-size:15px;color:#333;outline:none;margin-bottom:12px}
        .form-input::placeholder{color:#bbb}
        .form-input:focus{border-color:#e30613}
        .password-wrap{position:relative}
        .toggle-pw{position:absolute;right:14px;top:14px;cursor:pointer;font-size:18px;color:#999}
        .btn-masuk{display:block;width:100%;padding:16px;background:#e30613;color:#fff;border:none;border-radius:30px;font-size:16px;font-weight:bold;cursor:pointer;margin-top:30px}
        .btn-masuk:hover{background:#c70511}
        .btn-masuk:disabled{background:#ccc;cursor:not-allowed}
        .error{background:#fee;color:#c33;padding:10px;border-radius:8px;margin-bottom:12px;text-align:center;font-size:13px;display:none}
        .link-lupa{text-align:center;margin-top:16px}
        .link-lupa a{color:#e30613;font-size:13px;text-decoration:none;font-weight:bold}
        .home-bar{background:#fff;padding:8px 0;display:flex;justify-content:center;border-top:1px solid #eee}
        .home-indicator{width:120px;height:4px;background:#333;border-radius:2px}
    </style>
</head>
<body>
<div class="status-bar">
    <span id="clock">14:08</span>
    <div>üì∂ üîã</div>
</div>
<div class="red-section">
    <div class="top-bar">
        <a href="Login.html" class="back">‚Äπ</a>
        <div class="logo"><span>Alfamind</span></div>
        <div style="width:22px"></div>
    </div>
    <div class="hero-title">Masukkan Password</div>
    <div class="hero-desc">Masukkan password untuk melanjutkan ke akun kamu.</div>
</div>
<div class="form-section">
    <div class="error" id="error"></div>
    <div class="form-label">Nomor HP</div>
    <div class="phone-display" id="phoneDisplay">-</div>
    <div class="form-label">Password<span>*</span></div>
    <div class="password-wrap">
        <input type="password" id="password" class="form-input" placeholder="Masukkan password">
        <span class="toggle-pw" onclick="togglePw()">üëÅ</span>
    </div>
    <button class="btn-masuk" id="btnLogin">Masuk</button>
    <div class="link-lupa"><a href="#">Lupa Password?</a></div>
</div>
<div class="home-bar"><div class="home-indicator"></div></div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
<script>
var SUPABASE_URL = 'https://xobpjlcxioldrttoietl.supabase.co';
var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvYnBqbGN4aW9sZHJ0dG9pZXRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1NTU2NTUsImV4cCI6MjA4NzEzMTY1NX0.GNjqP3Zv4V1B9qsFhscywc_Qor4SJ_4hy3-uG27Vm0E';
var supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

var noTlp = localStorage.getItem('noTlp');
if(!noTlp) window.location.href = 'Login.html';
document.getElementById('phoneDisplay').textContent = noTlp;

function togglePw(){
    var pw = document.getElementById('password');
    pw.type = pw.type === 'password' ? 'text' : 'password';
}

document.getElementById('btnLogin').addEventListener('click', async function(){
    var btn = this;
    var password = document.getElementById('password').value;
    if(!password){ showError('Masukkan password!'); return; }
    btn.disabled = true; btn.textContent = 'Memproses...';
    var hashedPw = md5(password);
    var { data, error } = await supabase.from('data_user').select('*').eq('noTlp', noTlp).eq('password', hashedPw).single();
    btn.disabled = false; btn.textContent = 'Masuk';
    if(error || !data){ showError('Password salah!'); return; }
    localStorage.setItem('user', JSON.stringify({ memberId: data.memberId, noTlp: data.noTlp, nama: data.nama }));
    window.location.href = 'Home.html';
});

function showError(msg){
    var el = document.getElementById('error');
    el.textContent = msg; el.style.display = 'block';
    setTimeout(function(){ el.style.display='none'; }, 3000);
}
function updateClock(){var d=new Date();document.getElementById('clock').textContent=d.getHours().toString().padStart(2,'0')+':'+d.getMinutes().toString().padStart(2,'0');}
updateClock();setInterval(updateClock,1000);
</script>
</body>
</html>
