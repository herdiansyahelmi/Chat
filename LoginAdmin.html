<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Admin - Alfamind</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:Arial,sans-serif;background:#1a1a2e;min-height:100vh;display:flex;align-items:center;justify-content:center}
        .login-box{background:#fff;border-radius:16px;padding:40px;width:100%;max-width:380px;box-shadow:0 10px 40px rgba(0,0,0,.3)}
        .logo{font-size:28px;font-weight:900;font-style:italic;color:#e30613;text-align:center;margin-bottom:6px}
        .subtitle{text-align:center;font-size:13px;color:#999;margin-bottom:30px}
        .form-group{margin-bottom:16px}
        .form-group label{display:block;font-size:13px;color:#666;margin-bottom:6px}
        .form-group input{width:100%;padding:12px 14px;border:1px solid #ddd;border-radius:8px;font-size:14px;outline:none}
        .form-group input:focus{border-color:#e30613}
        .btn-login{width:100%;padding:14px;background:#e30613;color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:600;cursor:pointer;margin-top:10px}
        .btn-login:hover{background:#c70511}
        .btn-login:disabled{background:#ccc;cursor:not-allowed}
        .error{display:none;background:#fce4ec;color:#c62828;padding:10px;border-radius:8px;font-size:13px;text-align:center;margin-top:12px}
    </style>
</head>
<body>
<div class="login-box">
    <div class="logo">Alfamind</div>
    <div class="subtitle">Dashboard Admin</div>
    <div class="form-group">
        <label>Nomor HP</label>
        <input type="tel" id="noTlp" placeholder="Masukkan nomor HP">
    </div>
    <div class="form-group">
        <label>Password</label>
        <input type="password" id="password" placeholder="Masukkan password" onkeypress="if(event.key==='Enter')doLogin()">
    </div>
    <button class="btn-login" id="btnLogin" onclick="doLogin()">Login</button>
    <div class="error" id="error"></div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>
<script>
var SUPABASE_URL='https://xobpjlcxioldrttoietl.supabase.co';
var SUPABASE_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvYnBqbGN4aW9sZHJ0dG9pZXRsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE1NTU2NTUsImV4cCI6MjA4NzEzMTY1NX0.GNjqP3Zv4V1B9qsFhscywc_Qor4SJ_4hy3-uG27Vm0E';
var sb=window.supabase.createClient(SUPABASE_URL,SUPABASE_KEY);

async function doLogin(){
    var btn=document.getElementById('btnLogin');
    var noTlp=document.getElementById('noTlp').value.trim();
    var password=document.getElementById('password').value.trim();
    if(!noTlp||!password){showError('Isi semua field!');return;}

    btn.disabled=true;btn.textContent='Mengecek...';

    // Hash password dengan MD5
    var hashedPassword=md5(password);

    var {data,error}=await sb.from('data_user').select('*').eq('noTlp',noTlp).eq('password',hashedPassword);

    btn.disabled=false;btn.textContent='Login';

    if(error){showError('Error: '+error.message);return;}
    if(!data||data.length===0){showError('Nomor HP atau password salah!');return;}
    var user=data[0];
    if(!user.is_admin){showError('Akun ini bukan admin!');return;}

    localStorage.setItem('admin',JSON.stringify({memberId:user.memberId,nama:user.nama,noTlp:user.noTlp}));
    window.location.href='Dashboard.html';
}

function showError(msg){
    var el=document.getElementById('error');
    el.textContent=msg;el.style.display='block';
    setTimeout(function(){el.style.display='none';},3000);
}
</script>
</body>
</html>
